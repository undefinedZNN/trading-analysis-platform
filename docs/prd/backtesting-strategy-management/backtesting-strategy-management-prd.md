# 回测策略管理模块需求草稿

## 背景
- 交易数据管理模块已提供标准化行情与特征数据，满足回测基础数据需求。
- 量化研究团队需要集中管理策略脚本与参数，并快速发起多场景回测。
- 现有回测流程分散在本地脚本与零散文档中，缺乏版本管理与结果归档。

## 目标与范围
- 提供策略脚本、元数据、参数模板的统一管理能力，确保版本可追溯。
- 建立回测任务配置向导，让用户在可视化界面中完成策略回测配置与启动。
- 输出标准化的回测结果与指标分析，支持多维筛选、对比与导出。
- 当前阶段聚焦功能闭环，不对资源配额、监控告警等平台能力做深入实现。
- 相关技术方案详见《[回测系统架构设计](../../architecture/backtesting-system-architecture.md)》与《[回测脚本架构设计](../../architecture/backtesting-script-architecture.md)》。

## 功能需求

### 1. 回测策略管理
- **脚本上传与版本库**  
  支持上传/更新策略代码与依赖文件；自动生成版本号并记录描述；允许标记主版本，关联运行所需系统配置（运行时镜像、依赖包等）。
- **策略基础信息维护**  
  维护策略名称、适用市场/标的、交易频率、标签、团队归属、说明文档等元数据；提供列表、详情页、检索与筛选；记录创建人与更新时间。
- **参数模板与实例化**  
  为策略维护默认参数集（初始资金、交易成本/滑点模型、杠杆、风险约束等）；支持派生参数实例供回测任务引用；保留参数变更审计记录。
- **策略生命周期管理**  
  提供创建、编辑、复制、归档/取消归档操作；对敏感操作进行权限控制与访问日志记录；支持导出策略配置快照。

### 2. 回测执行
- **回测任务配置向导**  
  选择策略版本与参数实例；指定交易数据源（与交易数据管理模块打通）、回测时间区间、交易时段、初始资金、资金费率、滑点模型、风险约束；自动渲染策略注册的自定义变量字段，并支持输入校验与保存预设。
- **任务调度与状态管理**  
  每次执行生成独立任务 ID，记录状态流转（待执行/队列中/执行中/成功/失败/终止）；展示运行时长、触发人；支持手动终止、失败重试、复制配置后再次发起。
- **执行过程反馈**  
  实时展示进度百分比、里程碑阶段与关键日志片段；保留完整日志文件供下载回溯。
- **输出产物管理**  
  将回测输出（绩效指标 JSON、交易明细、图表数据、回测快照文件等）与任务记录关联；支持设置保留周期与下载权限。

### 3. 回测结果分析
- **基础绩效指标库**  
  标准化输出收益率、年化收益、最大回撤、夏普比率、卡玛比率、胜率、收益波动等指标；可配置基准组合用于对比。
- **多维筛选与因子分析**  
  按交易因子、时间窗口、市场情境（波动率、成交量分层）、仓位区间等维度筛选回测数据；支持组合条件过滤与保存常用筛选。
- **事件复盘与上下文还原**  
  展示账户净值曲线、订单/成交明细、资金占用、风险提示日志等视图；支持跳转到特定时间段查看上下文。
- **对比与导出**  
  支持多任务/多版本对比视图，展示指标、净值曲线与收益分布；允许导出报表（PDF/Excel）与原始数据集，方便外部分析或汇报。


> 本文为阶段性草稿，后续将根据产品评审与技术评估持续迭代。



